import{r as t,h as i,H as a}from"./p-cd2828d1.js";import{d as s}from"./p-bb39c509.js";import"./p-4c11f27f.js";import{A as e}from"./p-c60f5320.js";import{F as r}from"./p-6249f205.js";import{t as p}from"./p-df5b8a0d.js";const o=class{constructor(i){t(this,i),this.initialFiles=[],this.isMobile=window.innerWidth<768,this.files=[],this.fetchingApi=!1,this.searchQuery="",this.fetchApplication=()=>{this.fetchingApi=!0,e().get(this.match.params.slug).then(this.handleApplicationSuccess).then(this.handleFileSuccess).catch(this.handleError).finally(()=>this.fetchingApi=!1)},this.handleApplicationSuccess=t=>(this.application=t.data,this.fetchFiles(this.application.id)),this.handleFileSuccess=t=>{this.files=t.data,this.initialFiles=t.data},this.fetchFiles=t=>r().listApplicationFiles(t),this.handleError=t=>{if(!t.error)return console.log(t);p().danger(t.error)},this.handleFileUploaded=t=>{const{application:i,files:a}=this,s=t.detail;this.initialFiles=[s,...a],this.searchQuery||""!==this.searchQuery||(this.files=[s,...a]),this.application=Object.assign({},i)},this.onSearch=s(t=>{this.searchQuery=t.detail,t.detail&&""!==t.detail?r().search({applicationId:this.application.id,query:t.detail}).then(t=>{this.files=t.data}).catch(this.handleError):this.files=this.initialFiles},300)}listenFileWasDeleted(t){const i=t.detail;this.files=this.files.filter(t=>t.id!==i.id)}componentWillLoad(){this.fetchApplication()}render(){if(this.fetchingApi)return i("ta-loader",null);const{application:t}=this;return i(a,null,i("div",{class:"wrapper"},i("div",{class:"left-side"},i("ta-dragger",{onTaFileUpload:this.handleFileUploaded,applicationId:this.application.id},i("ta-app-page",null,i("ta-page-header",{pageTitle:t.name}),i("div",{class:"file-search"},i("ta-input",{value:this.searchQuery,onTaInput:this.onSearch,label:`Search ${this.isMobile?"":"(Hint: you can search an image by its content)"}`,type:"search"})),i("div",{class:"files-wrapper"},this.files.map(t=>i("ta-file-card",{file:t})))))),i("application-details-sidebar",{application:this.application})))}};o.style="application-details-view{}ta-error{--ta-error-bg-color:#fffbe6;--ta-error-color:rgba(0, 0, 0, 0.65);--ta-error-border:1px solid #ffe58f;--ta-error-margin-bottom:6px;--ta-error-padding:8px 15px}.files-wrapper{display:grid;grid-template-columns:auto auto auto auto;grid-gap:18px}.page-actions{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.icon{margin-left:10px}.wrapper{display:grid;grid-template-columns:auto minmax(auto, 280px)}@media (max-width: 1500px){.files-wrapper{grid-template-columns:auto auto auto}}@media (max-width: 1200px){.wrapper{grid-template-columns:auto 200px}.files-wrapper{grid-template-columns:auto auto auto}}@media (max-width: 768px){.wrapper{grid-template-columns:auto 150px}}@media (max-width: 768px){.wrapper{grid-template-columns:auto 0px}}@media (max-width: 600px){.files-wrapper{grid-template-columns:auto auto}}@media (max-width: 400px){.files-wrapper{grid-template-columns:auto}}";export{o as application_details_view}