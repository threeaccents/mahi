System.register(["./p-05ba43f8.system.js","./p-f2ebe6a2.system.js","./p-08914b53.system.js","./p-16d83290.system.js"],(function(e){"use strict";var t,r,s,i,a;return{setters:[function(e){t=e.r;r=e.h;s=e.H},function(){},function(e){i=e.A},function(e){a=e.t}],execute:function(){const n={name:"",description:"",deliveryUrl:"",storageEngine:"s3",storageSecretKey:"",storageEndpoint:"",storageRegion:"",storageAccessKey:""};const o=["sfo1","sfo2","sfo3","nyc1","nyc2","nyc3","ams1","ams2","ams3","sgp1","lon1","fra1","tor1","blr1"];const c=["us-east-2","us-east-1","us-west-1","us-west-2","ap-east-1","ap-south-1","ap-northeast-3","ap-northeast-2","ap-southeast-1","ap-southeast-2","ap-northeast-1","ca-central-1","cn-north-1","cn-northwest-1","eu-central-1","eu-west-1","eu-west-2","eu-west-3","eu-north-1","sa-east-1","me-south-1"];const l=["us-east-1","us-west-1","eu-central-1"];const p=":host{display:block}.form-title{font-size:24px;font-weight:bold;font-stretch:normal;font-style:normal;line-height:normal;letter-spacing:-0.09px;color:var(--primary-text-color)}label{font-size:14px;font-weight:bold;font-stretch:normal;font-style:normal;line-height:normal;letter-spacing:-0.05px;color:var(--dark-text-color);margin-bottom:24px;display:block}.header{display:-ms-flexbox;display:flex;-ms-flex-pack:end;justify-content:flex-end}.close-icon{font-size:24px;font-weight:normal;font-stretch:normal;font-style:normal;line-height:normal;letter-spacing:-0.09px;text-align:center;color:var(--light-text-color);cursor:pointer}ta-icon{--ta-icon-fill:#c3cbd3}";const h={nameErr:"",storageSecretKeyErr:"",storageAccessKeyErr:"",storageRegionErr:"",deliveryUrlErr:"",error:""};const u=e("create_application_view",class{constructor(e){t(this,e);this.newApplication=n;this.formErr=h;this.creatingApplication=false;this.spaceUsersOptions=[];this.onSubmit=e=>{e.preventDefault();this.validate().then(this.createApplication).catch(this.handleValidationErrors)};this.handleValidationErrors=e=>{this.formErr=e};this.createApplication=()=>{this.creatingApplication=true;const e=this.newApplication;i().create(e).then(this.onCreateApplicationSuccess).catch(this.handleError).finally(()=>this.creatingApplication=false)};this.onCreateApplicationSuccess=e=>{a().success("Application was created!");this.resetForm();this.history.push(`/applications/${e.data.id}`)};this.handleError=e=>{if(!e.error){this.formErr.error="Oops! Something went wrong. Please refresh and try again";return console.log(e)}const t=e.error;if(t.includes("application name is taken")){this.formErr=Object.assign(Object.assign({},this.formErr),{nameErr:"Application name is taken"});return}if(t.includes("connection")){this.formErr.error="Error with connection. Please double check your credentials are correct";return console.log(e)}a().danger(t)};this.validate=()=>{const{newApplication:e}=this;let t={};if(e.name===""){t=Object.assign(Object.assign({},t),{nameErr:"Name is required"})}if(e.deliveryUrl===""){t=Object.assign(Object.assign({},t),{deliveryUrlErr:"CDN url is required"})}if(e.storageAccessKey===""){t=Object.assign(Object.assign({},t),{storageAccessKeyErr:"Access key is required"})}if(e.storageSecretKey===""){t=Object.assign(Object.assign({},t),{storageSecretKeyErr:"Secret key is required"})}if(e.storageEngine!=="b2"&&e.storageRegion===""){t=Object.assign(Object.assign({},t),{storageRegionErr:"Bucket region is required"})}return Object.keys(t).length===0?Promise.resolve():Promise.reject(t)};this.updateNewApplication=(e,t)=>{this.formErr=h;this.newApplication=Object.assign(Object.assign({},this.newApplication),{[e]:t})};this.handleClose=()=>{const e=this.history.location.pathname;this.resetForm();this.history.push(e)};this.resetForm=()=>{this.newApplication=n;this.formErr=h};this.getCustomFormFields=()=>{const{newApplication:e,formErr:t}=this;const{storageRegionErr:s,storageSecretKeyErr:i,storageAccessKeyErr:a}=t;return r("span",null,r("custom-storage-engine-input",{value:e.storageEngine,onTaSelect:e=>this.updateNewApplication("storageEngine",e.detail)}),r("span",null,r("ta-input",{value:e.storageAccessKey,label:"API Access Key",onTaInput:e=>this.updateNewApplication("storageAccessKey",e.detail),error:a}),r("ta-input",{type:"password",value:e.storageSecretKey,label:"API Secret Key",onTaInput:e=>this.updateNewApplication("storageSecretKey",e.detail),error:i}),e.storageEngine!=="b2"?r("ta-select",{value:e.storageRegion,onTaSelect:e=>this.updateNewApplication("storageRegion",e.detail),placeholder:"Select Bucket Region",error:s},this.getStorageRegions().map(e=>r("ta-select-option",{value:e,label:e.toUpperCase()}))):null))}}getStorageRegions(){switch(this.newApplication.storageEngine){case"digital_ocean":return o;case"s3":return c;case"wasabi":return l;default:return[]}}render(){const{newApplication:e,formErr:t}=this;const{nameErr:i,error:a,deliveryUrlErr:n}=t;return r(s,null,r("div",{class:"header"},r("div",{class:"close-icon",onClick:this.handleClose},r("ta-icon",{icon:"close"}))),r("ta-form",{onTaSubmit:e=>this.onSubmit(e)},r("label",null,"Create Application"),r("ta-input",{value:e.name,label:"Application Name",onTaInput:e=>this.updateNewApplication("name",e.detail),error:i}),r("ta-input",{value:e.deliveryUrl,label:"CDN Url",onTaInput:e=>this.updateNewApplication("deliveryUrl",e.detail),error:n}),r("ta-textarea",{value:e.description,label:"Description",onTaInput:e=>this.updateNewApplication("description",e.detail)}),r("label",null,"Storage Details"),this.getCustomFormFields(),r("ta-error",{error:a}),r("ta-button",{loading:this.creatingApplication,onTaClick:e=>this.onSubmit(e)},"Create Application"),r("ta-button",{color:"white",onTaClick:this.handleClose},"Cancel")))}});u.style=p}}}));