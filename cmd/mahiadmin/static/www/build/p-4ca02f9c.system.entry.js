System.register(["./p-05ba43f8.system.js","./p-f2ebe6a2.system.js","./p-08914b53.system.js","./p-16d83290.system.js","./p-4919965f.system.js"],(function(t){"use strict";var i,e,s,a,n,o,l;return{setters:[function(t){i=t.r;e=t.h;s=t.d;a=t.H},function(){},function(t){n=t.A},function(t){o=t.t},function(t){l=t.U}],execute:function(){const r=":host{display:block}.form-title{font-size:24px;font-weight:bold;font-stretch:normal;font-style:normal;line-height:normal;letter-spacing:-0.09px;color:var(--primary-text-color)}label{font-size:14px;font-weight:bold;font-stretch:normal;font-style:normal;line-height:normal;letter-spacing:-0.05px;color:var(--dark-text-color);margin-bottom:24px;display:block}.header{display:-ms-flexbox;display:flex;-ms-flex-pack:end;justify-content:flex-end}.close-icon{font-size:24px;font-weight:normal;font-stretch:normal;font-style:normal;line-height:normal;letter-spacing:-0.09px;text-align:center;color:var(--light-text-color);cursor:pointer}ta-icon{--ta-icon-fill:#c3cbd3}";const c={name:"",error:""};const p=t("edit_application_view",class{constructor(t){i(this,t);this.fetchingApplication=false;this.application=null;this.fetchingUsers=true;this.spaceUsersOptions=[];this.formErr=c;this.updatingApplication=false;this.applicationId=this.history.location.query.applicationId;this.getApplicationState=()=>{const{state:t}=this.history.location;if(!t||!t.application)return this.fetchApplication();const{name:i,description:e,users:s}=t.application;this.application={name:i,description:e,userIds:s.map(t=>t.id)};this.initialApplication=this.application};this.fetchApplication=()=>{this.fetchingApplication=true;n().get(this.applicationId).then(this.onFetchApplicationSuccess).catch(this.handleError).finally(()=>this.fetchingApplication=false)};this.onFetchApplicationSuccess=t=>{const i=t.data;const{name:e,description:s}=i;this.application={name:e,description:s};this.initialApplication=this.application};this.loadUsers=()=>{l().listSpaceUsers().then(this.onListSpaceUserSuccess).catch(this.handleError).finally(()=>this.fetchingUsers=false)};this.onListSpaceUserSuccess=t=>{const i=t.data.map(t=>({text:`${t.firstName} ${t.lastName}`,value:t.id}));this.spaceUsersOptions=i};this.handleError=t=>{if(!t.error){o().danger("Oops! Something went wrong. Please refresh and try again");return console.log(t)}this.formErr=Object.assign(Object.assign({},this.formErr),{error:t.error})};this.validate=()=>{const{application:t}=this;let i={};if(t.name===""){i=Object.assign(Object.assign({},i),{name:"Name is required"})}return Object.keys(i).length===0?Promise.resolve():Promise.reject(i)};this.onSubmit=t=>{t.preventDefault();this.validate().then(this.updateApplication).catch(this.handleValidationErrors)};this.handleValidationErrors=t=>{this.formErr=t};this.updateApplication=()=>{this.updatingApplication=true;const t=this.application;n().update(this.applicationId,t).then(this.onUpdateApplicationSuccess).catch(this.handleError).finally(()=>this.updatingApplication=false)};this.onUpdateApplicationSuccess=t=>{o().success("Application was updated!");this.taApplicationWasUpdated.emit(t.data);this.handleClose()};this.handleClose=()=>{const t=this.history.location.pathname;this.history.push(t)};this.updateApplicationField=(t,i)=>{this.formErr=c;this.application=Object.assign(Object.assign({},this.application),{[t]:i})};this.getUsersField=()=>{const{fetchingUsers:t,spaceUsersOptions:i,application:s}=this;if(i.length===0)return;return e("ta-multi-select",{loading:t,label:"Add Users",value:s.userIds,options:i,onTaSelect:t=>this.updateApplicationField("userIds",t.detail)})};this.taApplicationWasUpdated=s(this,"taApplicationWasUpdated",7)}componentWillLoad(){this.loadUsers();this.getApplicationState()}get hasNoFieldUpdates(){return JSON.stringify(this.initialApplication)===JSON.stringify(this.application)}render(){const{application:t,formErr:i}=this;const{name:s,error:n}=i;if(this.fetchingApplication)return e("ta-loader",null);return e(a,null,e("div",{class:"header"},e("div",{class:"close-icon",onClick:this.handleClose},e("ta-icon",{icon:"close"}))),e("ta-form",{onTaSubmit:t=>this.onSubmit(t)},e("label",null,"Edit Application"),e("ta-input",{value:t.name,label:"Application Name",onTaInput:t=>this.updateApplicationField("name",t.detail),error:s}),e("ta-textarea",{value:t.description,label:"Description",onTaInput:t=>this.updateApplicationField("description",t.detail)}),this.getUsersField(),e("ta-error",{error:n}),e("ta-button",{disabled:this.hasNoFieldUpdates,loading:this.updatingApplication,onTaClick:t=>this.onSubmit(t)},"Save"),e("ta-button",{color:"white",onTaClick:this.handleClose},"Cancel")))}});p.style=r}}}));